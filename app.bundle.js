(()=>{"use strict";var t={523:(t,e,n)=>{n.d(e,{A:()=>c});var s=n(601),r=n.n(s),a=n(314),o=n.n(a)()(r());o.push([t.id,"body {\n    margin: 0;\n    overflow: hidden;\n}\n\n* {\n    image-rendering: crisp-edges;\n    -webkit-user-select: none;\n    /* Safari */\n    -ms-user-select: none;\n    /* IE 10 and IE 11 */\n    user-select: none;\n    /* Standard syntax */\n}\n\n:root {\n    --boxes-sized: 10vmin;\n    /*\n    --dog-rotation: rotate(90deg) rotateY(180deg);\n    */\n    /*--dog-rotation: 0deg;*/\n}\n\n.flex {\n    display: flex;\n    flex-direction: row;\n    height: 100vh;\n}\n\n#compile {\n    position: absolute;\n    top: calc(100% - 10px);\n    left: calc(100% - 10px);\n    width: 10vmin;\n    height: 10vmin;\n    border-radius: 50%;\n    transform: translate(-100%, -100%);\n}\n\niframe {\n    flex: 3;\n    border: none;\n}\n\n.sensor_emulator {\n    justify-content: center;\n    align-items: center;\n    overflow: scroll;\n    flex: 2;\n}\n\n#action_limit {\n    position: absolute;\n    top: 0;\n    left: 100%;\n    width: max-content;\n    padding-right: 15px;\n    transform: translateX(-100%);\n}\n\n.row {\n    display: flex;\n    flex-direction: row;\n    justify-content: center;\n    height: 100%;\n    width: 100%;\n}\n\n.boxes {\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: center;\n    align-items: center;\n    height: 100%;\n    width: 100%;\n    background-size: contain;\n}",""]);const c=o},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",s=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),s&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),s&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,s,r,a){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var c=0;c<this.length;c++){var i=this[c][0];null!=i&&(o[i]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);s&&o[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},601:t=>{t.exports=function(t){return t[1]}},72:t=>{var e=[];function n(t){for(var n=-1,s=0;s<e.length;s++)if(e[s].identifier===t){n=s;break}return n}function s(t,s){for(var a={},o=[],c=0;c<t.length;c++){var i=t[c],l=s.base?i[0]+s.base:i[0],u=a[l]||0,p="".concat(l," ").concat(u);a[l]=u+1;var d=n(p),h={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==d)e[d].references++,e[d].updater(h);else{var f=r(h,s);s.byIndex=c,e.splice(c,0,{identifier:p,updater:f,references:1})}o.push(p)}return o}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var a=s(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<a.length;o++){var c=n(a[o]);e[c].references--}for(var i=s(t,r),l=0;l<a.length;l++){var u=n(a[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}a=i}}},659:t=>{var e={};t.exports=function(t,n){var s=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var s="";n.supports&&(s+="@supports (".concat(n.supports,") {")),n.media&&(s+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(s+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),s+=n.css,r&&(s+="}"),n.media&&(s+="}"),n.supports&&(s+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(s){var r=e[s];if(void 0!==r)return r.exports;var a=e[s]={id:s,exports:{}};return t[s](a,a.exports,n),a.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");if(s.length)for(var r=s.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=s[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.nc=void 0;var s=n(72),r=n.n(s),a=n(825),o=n.n(a),c=n(659),i=n.n(c),l=n(56),u=n.n(l),p=n(540),d=n.n(p),h=n(113),f=n.n(h),w=n(523),m={};m.styleTagTransform=f(),m.setAttributes=u(),m.insert=i().bind(null,"head"),m.domAPI=o(),m.insertStyleElement=d(),r()(w.A,m),w.A&&w.A.locals&&w.A.locals;class y{workspace;blockData;constructor(t,e){this.workspace=t,this.blockData=e}clear(){this.workspace.clearCache()}async run(t=!0){if(t&&null!=this.workspace.actionAvaible){var e=this.workspace.actionAvaible??0;this.workspace.actionAvaible=e-1}this.workspace.render(),self.postMessage(this.workspace);const n=this.blockData.next;if(n){const t=B(this.workspace,n.block);await t.run()}}}class b extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){const t=this.blockData.inputs;if(t){const e=t.DO.block;await B(this.workspace,e).run()}await super.run(!1)}}class k extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){const t=this.blockData.inputs;if(t){const e=await B(this.workspace,W(t.SECONDS)).run();await new Promise((t=>setTimeout(t,1e3*e)))}await super.run(!1)}}class v extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){super.clear();const t=this.blockData.inputs.TIMES,e=await B(this.workspace,W(t)).run();for(let t=0;t<e;t++)if(this.blockData.inputs.DO){const t=this.blockData.inputs.DO.block;await B(this.workspace,t).run()}await super.run(!1)}}class x extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){return super.clear(),this.blockData.fields.NUM}}class g extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){super.clear();const t=await B(this.workspace,W(this.blockData.inputs.A)).run(),e=await B(this.workspace,W(this.blockData.inputs.B)).run();switch(this.blockData.fields.OP){case"ADD":return t+e;case"SUBTRACT":return t-e;case"MULTIPLY":return t*e;case"DIVIDE":return t/e;case"POWER":return Math.pow(t,e);default:return 0}}}class D{x;y;constructor(t,e){this.x=t,this.y=e}static init(t){return new D(t.x,t.y)}}const E=n.p+"assets/30339d382568b7f27a62.png",C=n.p+"assets/0e6f80409f96da26f0a5.png";class A extends D{state=!1;constructor(t){super(t.x,t.y)}static init=t=>new A(D.init(t));render(){const t=document.createElement("img");t.src=this.state?C:E,t.className="led",t.style.position="relative",t.style.top=100*this.y+"px",t.style.left=100*this.x+"px",t.style.width="250px",t.style.height="250px",t.style.rotate="90deg",document.getElementsByClassName("sensor_emulator")[0].appendChild(t)}clear(){}}const T=n.p+"assets/79d5f5b19a4d1f2402ab.png",S=n.p+"assets/f4d6b8cd2294a181534c.png";class _ extends D{state=!1;constructor(t){super(t.x,t.y)}static init=t=>new _(D.init(t));render(){const t=document.createElement("img");t.src=this.state?T:S,t.className="led",t.style.position="relative",t.style.top=100*this.y+"px",t.style.left=100*this.x+"px",t.style.width="200px",t.style.height="200px",document.getElementsByClassName("sensor_emulator")[0].appendChild(t)}clear(){}}const N=n.p+"assets/3c2466d805103e0d3569.png",O=n.p+"assets/3c004d76426d36101cd1.png";class M extends D{rotation=90;constructor(t){super(t.x,t.y)}static init=t=>new M(D.init(t));render(){const t=document.createElement("div");t.className="servo",t.style.position="relative",t.style.top=100*this.y+"px",t.style.left=100*this.x+"px",t.style.width="200px",t.style.height="200px";const e=document.createElement("img");e.style.position="absolute",e.style.width="100%",e.style.height="100%",e.src=N;const n=document.createElement("img");n.style.position="absolute",n.style.width="100%",n.style.height="100%",n.style.transform=`rotate(${this.rotation}deg)`,n.src=O,t.appendChild(e),t.appendChild(n),document.getElementsByClassName("sensor_emulator")[0].appendChild(t)}clear(){}}class I extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){super.clear(),this.workspace.entities.forEach((t=>{t instanceof _&&(t.state="0"===this.blockData.fields.LED)})),await super.run()}}class L extends y{workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){if(super.clear(),this.blockData.inputs){const t=await B(this.workspace,W(this.blockData.inputs.MOTOR)).run();this.workspace.entities.forEach((e=>{e instanceof M&&(e.rotation=t)}))}await super.run()}}class P{context;constructor(t){var e=new AudioContext,n=e.createOscillator();n.type="square",n.frequency.value=2*t,n.connect(e.destination),n.start(),this.context=e}stop(){this.context.close()}}class j extends y{beep=null;workspace;blockData;constructor(t,e){super(t,e),this.workspace=t,this.blockData=e}async run(){super.clear();const t=this.workspace.cacheCodeExecution.find((t=>t instanceof j));if(t&&(t.beep.stop(),this.workspace.cacheCodeExecution=this.workspace.cacheCodeExecution.filter((e=>e!==t))),this.blockData.inputs){const t=await B(this.workspace,W(this.blockData.inputs.TONE)).run();if(this.workspace.entities.forEach((e=>{e instanceof A&&(e.state=t>0)})),t<=0)return;this.beep=new P(t),this.workspace.cacheCodeExecution.push(this)}await super.run()}}function B(t,e){switch(e.type){case"start_event":return new b(t,e);case"wait_for":return new k(t,e);case"led_set":return new I(t,e);case"buzzer_set":return new j(t,e);case"rotate_servo":return new L(t,e);case"math_number":return new x(t,e);case"math_arithmetic":return new g(t,e);case"controls_repeat_ext":return new v(t,e);default:throw new Error(`Block not found ${e.type}`)}}function W(t){return t.block?t.block:t.shadow}const $=new class{entities=[];actionAvaible=null;cacheWorkspace=[];cacheCodeExecution=[];constructor(t=10){this.clearCache(),this.actionAvaible=t,this.render();const e=structuredClone([this.entities,structuredClone(t)]);this.cacheWorkspace=e}addEntity(t){this.entities.push(t);const e=t;this.cacheWorkspace[0].push(e.constructor.init(t)),this.clearCache(),this.render()}resetLevel(){const t=structuredClone(this.cacheWorkspace);this.entities=[],this.cacheWorkspace[0].forEach(((t,e)=>{"init"in t.constructor&&this.entities.push(t.constructor.init(t))})),this.actionAvaible=t[1],this.render()}clearCache(){var t={...this};for(const e in t.entities){const n=t.entities[e];null!=n&&"clear"in n&&n.clear()}}render(){if("undefined"!=typeof window){document.getElementsByClassName("sensor_emulator")[0].innerHTML="";var t={...this};for(const e in t.entities){const n=t.entities[e];null!=n&&"render"in n&&n.render()}if(null==this.actionAvaible)return}}};$.addEntity(new _(new D(1,1))),$.addEntity(new A(new D(2,1))),$.addEntity(new M(new D(1,2)));var H=JSON.parse('{"blocks":{"languageVersion":0,"blocks":[{"type":"start_event","id":"Y$PnHc11]nleH0`8*L$#","x":250,"y":250}]}}');document.querySelector("body > div > iframe").contentWindow.addEventListener("message",(function(t){H=JSON.parse(t.data)}),!1);var R=!1;document.getElementById("compile")?.addEventListener("click",(async t=>{R||(R=!0,await async function(t,e){t.resetLevel(),await new Promise((t=>setTimeout(t,250)));const n=e.blocks;if(!n)return;const s=n.blocks;for(let e=0;e<s.length;e++){const n=s[e];"start_event"===n.type&&await B(t,n).run()}}($,H),R=!1)}))})();